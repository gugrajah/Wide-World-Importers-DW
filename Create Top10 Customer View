--Create the Top10Customers view
CREATE OR ALTER VIEW [dbo].[Top10Customers]
AS
SELECT TOP(10)
    FS.[CustomerKey],
    DC.[Customer],
    CAST(ROUND(SUM(FS.[TotalIncludingTax]), 2) AS DECIMAL(18,2)) AS [TotalSalesAmount]
FROM 
    [dbo].[dimension_customer] AS DC
INNER JOIN [dbo].[fact_sale] AS FS
    ON DC.[CustomerKey] = FS.[CustomerKey]
GROUP BY 
    FS.[CustomerKey],
    DC.[Customer]
ORDER BY  
    [TotalSalesAmount] DESC;
GO